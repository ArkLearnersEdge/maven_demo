pipeline
{
 agent slave
 stages
 {
   stage('ContinuousDownload') 
    {
		steps
		{
		 git 'https://github.com/ArkLearnersEdge/maven.git'
		}
     
    }
	stage('ContinuousBuild') 
    {
		steps
		{
		 sh 'mvn package'
		}
     
    }
	stage('ContinuousDeploy') 
    {
		steps
		{
		 sh 'scp /home/ubuntu/.jenkins/workspace/Development/webapp/target/webapp.war ubuntu@172.31.85.238:/var/lib/tomcat8/webapps/testapp'
		}
     
    }
	stage('ContinuousTesting') 
    {
		steps
		{
		  git 'https://github.com/ArkLearnersEdge/FunctionalTesting.git'
		  sh 'java -jar /home/ubuntu/.jenkins/workspace/Development/testing.jar'
		}
     
    }
	post
    {
		success
		{
		
		  sh 'scp /home/ubuntu/.jenkins/workspace/Development/webapp/target/webapp.war ubuntu@172.31.92.171:/var/lib/tomcat8/webapps/abcd'
		}
		failure
		{
		 mail bcc: '', body: 'CI- CD stages are failed please resolve the issue', cc: 'manager@xyz.com,admin@xyz.com', from: '', replyTo: '', subject: 'CI-CD Failed', to: 'scrum@xyz.com'
		}
    }
 }
}
